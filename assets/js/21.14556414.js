(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{527:function(e,s,a){"use strict";a.r(s);var n=a(6),r=Object(n.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"安装要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装要求"}},[e._v("#")]),e._v(" 安装要求")]),e._v(" "),a("h2",{attrs:{id:"操作系统和docker-版本要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作系统和docker-版本要求"}},[e._v("#")]),e._v(" 操作系统和docker 版本要求")]),e._v(" "),a("p",[e._v("Rancher 应用可以兼容当前任何流行的 Linux 发行版和流行的 Docker 版本。自己测试还是用centos7 好用，centos8.1 还是会出现各种问题。")]),e._v(" "),a("p",[e._v("我们建议安装 ntp (Network Time Protocol)，这样可以防止在客户端和服务器之间因为时钟不同步而发生证书验证错误。\n")]),e._v(" "),a("h2",{attrs:{id:"安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[e._v("#")]),e._v(" 安装docker")]),e._v(" "),a("p",[e._v("任何运行 Rancher Server 的节点上都需要安装 Docker。")]),e._v(" "),a("p",[e._v("有两种安装 Docker 的选择。一种选择是参考官方 "),a("a",{attrs:{href:"https://docs.docker.com/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker 文档"),a("OutboundLink")],1),e._v("来了解如何在 Linux 上安装 Docker。这些安装步骤将根据 Linux 发行版而有所不同。")]),e._v(" "),a("h3",{attrs:{id:"rancher脚本安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rancher脚本安装docker"}},[e._v("#")]),e._v(" rancher脚本安装docker")]),e._v(" "),a("ul",[a("li",[e._v("另一种选择是使用 Rancher 提供的 Docker 安装脚本，该脚本可用于安装较新的 Docker 版本。")])]),e._v(" "),a("p",[e._v("例如，此命令可用于在 Ubuntu 上安装 Docker 18.09：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\ncurl https://releases.rancher.com/install-docker/18.09.sh | sh\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("最新")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\ncurl https://releases.rancher.com/install-docker/19.03.sh | sh\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("要了解某个 Docker 版本是否有可用的安装脚本，请参考这个"),a("a",{attrs:{href:"https://github.com/rancher/install-docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),a("OutboundLink")],1),e._v(" 仓库，这里包含了 Rancher 的所有 Docker 安装脚本。")]),e._v(" "),a("h3",{attrs:{id:"docker-官方安装方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-官方安装方式"}},[e._v("#")]),e._v(" docker 官方安装方式")]),e._v(" "),a("ul",[a("li",[e._v("1.卸载旧的版本")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n$ sudo yum remove docker \n\n​                  docker-client \n\n​                  docker-client-latest \n\n​                  docker-common \n\n​                  docker-latest \n\n​                  docker-latest-logrotate \n\n​                  docker-logrotate \n\n​                  docker-engine\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br")])]),a("ul",[a("li",[e._v("2.安装yum-utils")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n$ sudo yum install -y yum-utils\n\n\n\n$ sudo yum-config-manager     --add-repo     https://download.docker.com/linux/centos/docker-ce.repo\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("ul",[a("li",[e._v("3.安装docker")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\nsudo yum install docker-ce docker-ce-cli containerd.io \n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ul",[a("li",[e._v("4.安装指定版本的docker")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n$ yum list docker-ce --showduplicates | sort -r\n\n\n\ndocker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable\n\ndocker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable\n\ndocker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable\n\ndocker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br")])]),a("p",[e._v("比如安装docker-ce-18.09.1版本")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n$ sudo yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ul",[a("li",[e._v("5.启动")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\nsudo systemctl start docker\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ul",[a("li",[e._v("6.开机启动")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n systemctl enable docker.service\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h2",{attrs:{id:"单节点安装rancher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单节点安装rancher"}},[e._v("#")]),e._v(" 单节点安装rancher")]),e._v(" "),a("h3",{attrs:{id:"使用-rancher-默认的自签名证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-rancher-默认的自签名证书"}},[e._v("#")]),e._v(" 使用 Rancher 默认的自签名证书")]),e._v(" "),a("p",[e._v("如果要在不涉及身份验证的开发或测试环境中安装 Rancher，请使用其生成的自签名证书安装 Rancher。此安装选项省去了自己生成证书的麻烦。")]),e._v(" "),a("p",[e._v("登录到 Linux 主机，然后运行下面这个非常简洁安装命令。")]),e._v(" "),a("blockquote",[a("p",[e._v("在使用单节点安装时，Rancher Server 的数据默认保存在容器里。这意味着，在 Rancher Server 容器被删除时，Rancher Server 的数据将会丢失。您可以通过添加 -v 参数以挂载目录的方式将数据保存在 Rancher Server 所在的主机上。详情请参阅 "),a("a",{attrs:{href:"https://rancher2.docs.rancher.cn/docs/installation/other-installation-methods/single-node-docker/advanced/_index#persist-data",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rancher 单节点数据持久化"),a("OutboundLink")],1),e._v("。")])]),e._v(" "),a("ul",[a("li",[e._v("持久化数据")])]),e._v(" "),a("p",[e._v("Rancher 使用 etcd 作为数据存储。使用 Docker 安装时，将使用嵌入式 etcd。持久数据位于容器中的以下路径中：/var/lib/rancher。您可以将主机卷挂载到该位置，以将数据保留在运行 Rancher Server 容器的主机上。使用 RancherOS 时，请检查哪些持久性存储目录可用。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\ndocker run -d --restart=unless-stopped \n\n  -p 80:80 -p 443:443 \n\n  -v /opt/rancher:/var/lib/rancher \n\n  rancher/rancher:v2.4.3\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])]),a("h3",{attrs:{id:"在相同节点运行rancher-rancher-和-rancher-rancher-agent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在相同节点运行rancher-rancher-和-rancher-rancher-agent"}},[e._v("#")]),e._v(" 在相同节点运行rancher/rancher 和 rancher/rancher-agent")]),e._v(" "),a("p",[e._v("在要使用单个节点运行 Rancher 并将同一个节点添加到集群的情况下，必须为rancher/ rancher容器调整映射的主机端口。")]),e._v(" "),a("p",[e._v("如果将节点添加到集群中，它将部署使用端口 80 和 443 的 nginx ingress 控制器。这将与我们建议为rancher/ rancher容器公开的默认端口冲突。")]),e._v(" "),a("p",[e._v("请注意，不建议将此设置用于生产环境，这种方式仅用来方便进行开发/演示。")]),e._v(" "),a("p",[e._v("要更改主机端口映射，请将以下部分-p 80:80 -p 443:443替换为-p 8080:80 -p 8443:443：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\ndocker run -d --restart=unless-stopped \n\n  -p 8080:80 -p 8443:443 \n\n  -v /opt/rancher:/var/lib/rancher \n\n  rancher/rancher:v2.4.3\n\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);