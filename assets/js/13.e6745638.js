(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{517:function(n,s,a){"use strict";a.r(s);var e=a(6),t=Object(e.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"准备工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[n._v("#")]),n._v(" 准备工作")]),n._v(" "),a("p",[n._v("安装查看 Java 的版本号，推荐使用 Java 8。")]),n._v(" "),a("h2",{attrs:{id:"安装-flink"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-flink"}},[n._v("#")]),n._v(" 安装 Flink")]),n._v(" "),a("ul",[a("li",[n._v("在 Mac OS X 上安装 Flink 是非常方便的。推荐通过 homebrew 来安装。")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\n➜ ~ brew install apache-flink\n\n==> Downloading https://archive.apache.org/dist/flink/flink-1.9.1/flink-1.9.1-bi\n\n######################################################################## 100.0%\n\n🍺 /usr/local/Cellar/apache-flink/1.9.1: 166 files, 277MB, built in 1 minute 40 seconds\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("ul",[a("li",[n._v("检查安装：")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\n➜ ~ flink --version\n\nVersion: 1.9.1, Commit ID: 4d56de8\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("h2",{attrs:{id:"启动-flink"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动-flink"}},[n._v("#")]),n._v(" 启动 flink")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\n➜ ~ cd /usr/local/Cellar/apache-flink/1.9.1/libexec/bin\n\n➜ bin ls\n\nconfig.sh mesos-appmaster.sh start-zookeeper-quorum.sh\n\nfind-flink-home.sh mesos-taskmanager.sh stop-cluster.sh\n\nflink pyflink-gateway-server.sh stop-zookeeper-quorum.sh\n\nflink-console.sh pyflink-shell.sh taskmanager.sh\n\nflink-daemon.sh sql-client.sh yarn-session.sh\n\nhistoryserver.sh standalone-job.sh zookeeper.sh\n\njobmanager.sh start-cluster.sh\n\nmesos-appmaster-job.sh start-scala-shell.sh\n\n➜ bin ./start-cluster.sh\n\nStarting cluster.\n\nStarting standalonesession daemon on host 192.168.3.102.\n\nStarting taskexecutor daemon on host 192.168.3.102.\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br")])]),a("p",[n._v("接着就可以进入 web 页面(http://localhost:8081/) 查看")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink01-1202136.png",alt:"flink01"}})]),n._v(" "),a("h2",{attrs:{id:"demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo"}},[n._v("#")]),n._v(" demo")]),n._v(" "),a("h3",{attrs:{id:"_1、-新建一个maven-项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-新建一个maven-项目"}},[n._v("#")]),n._v(" 1、 新建一个maven 项目")]),n._v(" "),a("p",[n._v("创建工程：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\n $ mvn archetype:generate \n\n​      -DarchetypeGroupId=org.apache.flink \n\n​      -DarchetypeArtifactId=flink-quickstart-java \n\n​      -DarchetypeVersion=1.9.0\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("或者在idea里面添加archetype")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink02-1202165.png",alt:"flink02"}})]),n._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink03-1202186.png",alt:"flink03"}})]),n._v(" "),a("h3",{attrs:{id:"创建一个-sockettextstreamwordcount-文件-加入以下代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建一个-sockettextstreamwordcount-文件-加入以下代码"}},[n._v("#")]),n._v(" 创建一个 SocketTextStreamWordCount 文件，加入以下代码：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('\npackage org.leileitang;\n\n\n\nimport org.apache.flink.api.common.functions.FlatMapFunction;\n\nimport org.apache.flink.api.java.tuple.Tuple2;\n\nimport org.apache.flink.streaming.api.datastream.DataStreamSource;\n\nimport org.apache.flink.streaming.api.datastream.SingleOutputStreamOperator;\n\nimport org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;\n\nimport org.apache.flink.util.Collector;\n\npublic class SocketTextStreamWordCount {\n\n​    public static void main(String[] args) {\n\n​        if (args.length != 2) {\n\n​            System.err.println("USAGE:nSocketTextStreamWordCount <hostname> <port>");\n\n​            return;\n\n​        }\n\n​        String hostname = args[0];\n\n​        Integer port = Integer.parseInt(args[1]);\n\n\n\n​        // set up the streaming execution environment\n\n​        final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n\n\n\n​        //获取数据\n\n​        DataStreamSource<String> stream = env.socketTextStream(hostname, port);\n\n\n\n​        //计数\n\n​        SingleOutputStreamOperator<Tuple2<String, Integer>> sum = stream.flatMap(new LineSplitter())\n\n​                .keyBy(0)\n\n​                .sum(1);\n\n​        sum.print();\n\n\n\n​    }\n\n\n\n​    public static final class LineSplitter implements FlatMapFunction<String, Tuple2<String, Integer>> {\n\n​        @Override\n\n​        public void flatMap(String s, Collector<Tuple2<String, Integer>> collector) {\n\n​            String[] tokens = s.toLowerCase().split("W+");\n\n​            for (String token : tokens) {\n\n​                if (token.length() > 0) {\n\n​                    collector.collect(new Tuple2<String, Integer>(token, 1));\n\n​                }\n\n​            }\n\n\n\n​        }\n\n​    }\n\n}\n\n\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br"),a("span",{staticClass:"line-number"},[n._v("65")]),a("br"),a("span",{staticClass:"line-number"},[n._v("66")]),a("br"),a("span",{staticClass:"line-number"},[n._v("67")]),a("br"),a("span",{staticClass:"line-number"},[n._v("68")]),a("br"),a("span",{staticClass:"line-number"},[n._v("69")]),a("br"),a("span",{staticClass:"line-number"},[n._v("70")]),a("br"),a("span",{staticClass:"line-number"},[n._v("71")]),a("br"),a("span",{staticClass:"line-number"},[n._v("72")]),a("br"),a("span",{staticClass:"line-number"},[n._v("73")]),a("br"),a("span",{staticClass:"line-number"},[n._v("74")]),a("br"),a("span",{staticClass:"line-number"},[n._v("75")]),a("br"),a("span",{staticClass:"line-number"},[n._v("76")]),a("br"),a("span",{staticClass:"line-number"},[n._v("77")]),a("br"),a("span",{staticClass:"line-number"},[n._v("78")]),a("br"),a("span",{staticClass:"line-number"},[n._v("79")]),a("br"),a("span",{staticClass:"line-number"},[n._v("80")]),a("br"),a("span",{staticClass:"line-number"},[n._v("81")]),a("br"),a("span",{staticClass:"line-number"},[n._v("82")]),a("br"),a("span",{staticClass:"line-number"},[n._v("83")]),a("br"),a("span",{staticClass:"line-number"},[n._v("84")]),a("br"),a("span",{staticClass:"line-number"},[n._v("85")]),a("br"),a("span",{staticClass:"line-number"},[n._v("86")]),a("br"),a("span",{staticClass:"line-number"},[n._v("87")]),a("br"),a("span",{staticClass:"line-number"},[n._v("88")]),a("br"),a("span",{staticClass:"line-number"},[n._v("89")]),a("br"),a("span",{staticClass:"line-number"},[n._v("90")]),a("br"),a("span",{staticClass:"line-number"},[n._v("91")]),a("br")])]),a("p",[n._v("接着进入工程目录，使用以下命令打包。")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\nmvn clean package -Dmaven.test.skip=true\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink04-1202202.png",alt:"flink04"}})]),n._v(" "),a("p",[n._v("然后我们开启监听 9000 端口:")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("nc -l 9000  \n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("最后进入 flink 安装目录 bin 下执行以下命令跑程序：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\ncd /usr/local/Cellar/apache-flink/1.9.1/libexec/bin\n\nflink run -c org.leileitang.flink.SocketTextStreamWordCount /Users/tanglei/workspace/flink/target/flink-demo-1.0-SNAPSHOT.jar 127.0.0.1 9000\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink05-1202218.png",alt:"flink05"}})]),n._v(" "),a("p",[n._v("执行完上述命令后，我们可以在 webUI 中看到正在运行的程序：")]),n._v(" "),a("p",[n._v("![flink06](/Users/tanglei/Library/Mobile Documents/com~apple~CloudDocs/leileitangcom/背景图/flink06-1202233.png)")]),n._v(" "),a("p",[n._v("我们可以在 nc 监听端口中输入 text，比如：")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink07-1202243.png",alt:"flink07"}})]),n._v(" "),a("p",[n._v("然后我们通过 tail 命令看一下输出的 log 文件，来观察统计结果。进入目录 apache-flink/1.9.0/libexec/log，执行以下命令:")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\ncd /usr/local/Cellar/apache-flink/1.9.1/libexec/log\n![flink08](/images/flink08.png)\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/aaronTang98/image_store/blog/flink08-1202262.png",alt:"flink08"}})]),n._v(" "),a("h4",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[n._v("#")]),n._v(" 总结")]),n._v(" "),a("p",[n._v("本文描述了如何在 Mac 电脑上安装 Flink，及运行它。接着通过一个简单的 Flink 程序来介绍如何构建及运行Flink 程序。")])])}),[],!1,null,null,null);s.default=t.exports}}]);